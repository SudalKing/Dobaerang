<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<title>Post</title>
<link rel="stylesheet" th:href="@{/css/bootstrap.css}">
<link rel="stylesheet" th:href="@{/css/post.css}">
</head>
<body>

<!--Navbar Top Header-->
<header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow" th:replace="fragments/common-header"></header>
<!--------------------->

<div class="container-fluid">
<div class="row">

    <!--Navbar Side-->
    <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse" th:replace="fragments/common-side">
    </nav>
    <!-------------->

    <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-2 border-bottom">
            <h1 class="h2">Posting</h1>
            <div class="btn-toolbar mb-2 mb-md-0">
                <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">
                    <span data-feather="calendar" class="align-text-bottom"></span>
                    This week
                </button>
            </div>
        </div>


        <div class="table-responsive">
            <article>
                <!---------- Content Read ---------->
                <div th:object="${post}">
                    <div class="row-cols-auto">

                        <div class="container">

                            <footer class="d-flex flex-wrap justify-content-between align-items-center pb-1 mb-1">
                                <h5 class="col-md-4 mb-0 text-muted" th:text="${post.user.username}">Post 작성자</h5>

                                <a href="/" class="col-md-4 d-flex align-items-center justify-content-center mb-3 mb-md-0 me-md-auto link-dark text-decoration-none">
                                    <svg class="bi me-2" width="40" height="32"><use xlink:href="#bootstrap"/></svg>
                                </a>

                                <ul class="nav col-md-4 justify-content-end">
                                    <li class="nav-item">
                                        <a th:href="@{/post/modify(id=${post.id})}" class="nav-link text-muted px-2"
                                           th:if="${#authentication.name} == ${post.user.username}">수정</a>
                                    </li>
                                    <li class="nav-item">
                                        <!----url: /post/read/post.id---->
                                        <form th:action="@{/post/read/{id}(id=${post.id})}" th:method="delete">
                                            <input type="hidden" th:name="currentUsername" th:value="${#authentication.name}">
                                            <button class="nav-link text-muted px-2 border-0 bg-white"
                                                    th:if="${#authentication.name} == ${post.user.username} or ${#authentication.name} == 'admin'">삭제
                                            </button>
                                        </form>
                                    </li>
                                </ul>
                            </footer>

                            <div class="d-grid gap-2 d-md-flex border-top border-bottom">
                                <div class="badge text-bg-dark my-3">제목</div>
                                <div class="my-3" id="postTitle" th:text="${post.title}" readonly>제목</div>
                            </div>
                            <div class="d-grid gap-2 d-md-flex border-bottom">
                                <span class="badge text-bg-dark my-3" style="height: 22px">내용</span>
                                <div class="my-3" id="postContent" th:text="${post.content}" readonly>내용</div>
                            </div>
                        </div>
                    </div>

                    <!---------- Comment Form ---------->
                    <div>
                        <table class="table table-striped table-sm">
                            <tbody>
                            <tr th:each="comment : ${comments}">
                                <td th:text="${comment.user.username}">글쓴이</td>
                                <td th:text="${comment.content}">내용</td>
                                <td th:text="${#temporals.format(comment.createdAt, 'MM-dd HH:mm')}">생성시간</td>
                                <td th:text="${#temporals.format(comment.updatedAt, 'MM-dd HH:mm')}">수정시간</td>
                            </tr>
                            </tbody>
                        </table>

                        <div class="card">
                            <h5 class="card-header" sec:authentication="name">Current User</h5>
                                <form class="card-body" th:action="@{/post/comment}" method="post" th:object="${comment}">
                                    <input type="hidden" id="postId" th:name="postId" th:value="${post.id}">
                                    <div>
                                        <textarea th:name="content" class="form-control mb-1"
                                                  placeholder="Leave a comment here" id="floatingTextarea2">
                                        </textarea>
                                        <div class="d-grid gap-2 d-md-flex justify-content-end">
                                            <label for="floatingTextarea2">Comments</label>
                                            <button type="submit" class="btn btn-outline-primary">작성</button>
                                        </div>
                                    </div>
                                </form>
                        </div>

                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
<!--                            &lt;!&ndash;&#45;&#45;url: /api/read/post.id&#45;&#45;&ndash;&gt;-->
<!--                            <form class="me-md-2" th:action="@{/api/read/{id}(id=${post.id})}" th:method="delete">-->
<!--                                <input type="hidden" th:name="currentUsername" th:value="${#authentication.name}">-->
<!--                                <button class="btn btn-outline-danger"-->
<!--                                        th:if="${#authentication.name} == ${post.user.username} or ${#authentication.name} == 'admin'">삭제-->
<!--                                </button>-->
<!--                            </form>-->
                            <a type="button" class="btn btn-outline-dark" th:href="@{/post/list}">뒤로</a>
                        </div>
                    </div>
                </div>
                    <!--------------------------------->
            </article>
        </div>
    </main>
</div>
</div>



<script th:src="@{/js/bootstrap.js}"></script>


</body>
</html>